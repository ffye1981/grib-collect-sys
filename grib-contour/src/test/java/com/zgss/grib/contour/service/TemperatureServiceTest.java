package com.zgss.grib.contour.service;

import com.zgss.grib.contour.entity.Temperature;
import com.zgss.grib.contour.service.Impl.TemperatureService;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.test.context.junit4.SpringRunner;

import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;
import java.util.List;

@RunWith(SpringRunner.class)
@SpringBootTest
public class TemperatureServiceTest {
    private SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd hh:mm:ss");

    @Autowired
    TemperatureService temperatureService;

    @Test
    public void insert() {
        Temperature t = new Temperature();
        t.setLon(0d);
        t.setLat(0d);
        try {
            t.setReftime(sdf.parse("2019-08-29 11:00:00"));
        } catch (ParseException e) {
            e.printStackTrace();
        }
        t.setValue(new Double(227));
        t.setSurfacevalue(new Integer(20000));
        t.setGeojson("{\"type\":\"MultiPolygon\",\"coordinates\":[[[[112.019198999734,3.75840099960652],[112.016829000158,3.75775699958592],[112.015105999842,3.76076199966667],[112.019198999734,3.75840099960652]]],[[[112.033632999863,3.7657100003164],[112.031263000287,3.76506500024954],[112.029539999971,3.76807100037638],[112.033632999863,3.7657100003164]]],[[[112.039234000049,3.76592500033865],[112.03686499962,3.76528000027196],[112.035141000157,3.76828600039863],[112.039234000049,3.76592500033865]]],[[[110.685669000224,20.1611799996574],[110.935157000395,20.0112919997261],[111.041734999571,19.642648000405],[110.861023000012,19.5245309997059],[110.41200799957,18.6611349996806],[109.574727999698,18.1598329999931],[108.686047000069,18.5057069996784],[108.63492999992,19.3005199998982],[109.170261000445,19.7168660001658],[109.261795000139,19.8999419999234],[109.710202000422,20.0114360000715],[110.376507000098,20.0868680000582],[110.685669000224,20.1611799996574]]],[[[121.585636000301,25.2973669998871],[121.995683999717,25.0071579996421],[121.820772999674,24.848285999999],[121.853497999733,24.4823790000909],[121.608517999706,24.0798840000467],[121.40316100038,23.1241409997075],[120.970538999575,22.5631290002033],[120.854114999608,21.9046790003358],[120.723191000065,21.9215090003402],[120.626720000228,22.3147560001894],[120.256197999738,22.6134260003098],[120.031223999588,23.0811459999879],[120.129809999832,23.632287000245],[121.028965999581,25.0295849996481],[121.585636000301,25.2973669998871]]],[[[121.668269999661,28.3465439999057],[121.664683755448,28.3482733667487],[121.664687000938,28.3482841171503],[121.669080000142,28.3493479997105],[121.668269999661,28.3465439999057]]],[[[118.943240000126,37.3430560000346],[118.938090000054,37.3443640000986],[118.943480000402,37.3452719997031],[118.943240000126,37.3430560000346]]],[[[122.057204000265,40.1940850004225],[122.051763000262,40.2020730000689],[122.055460999925,40.2033070003179],[122.057204000265,40.1940850004225]]],[[[123.478660000359,53.4960939999383],[124.861509999887,53.0904159996987],[125.12672999979,53.2019160001233],[125.604149999823,53.0820499997079],[125.74285999959,52.9830249999039],[125.661960000154,52.8616679999784],[126.107309999757,52.7656399998863],[125.959919999908,52.6281970000916],[126.427890000323,52.293910999693],[126.298420000383,52.2034720001328],[126.553409999772,52.1325609999902],[126.453030000434,51.9459920001308],[126.917719999778,51.3820420000384],[126.823839999816,51.2618869997853],[126.973370000325,51.3265719996982],[126.91147000024,51.0585779995751],[127.293259999649,50.7523960001753],[127.324240000176,50.3341979999378],[127.602829999705,50.2238660003158],[127.520450000367,49.8178630003773],[127.808080000392,49.5859719996081],[128.749280000072,49.5917279997474],[129.100339999692,49.3503040000297],[129.493099999566,49.4266400003358],[130.230700000005,48.8612139996265],[130.675110000326,48.8770679995886],[130.520030000184,48.6123500003524],[130.83219999963,48.3016009998863],[130.650500000375,48.1019360004461],[131.004269999961,47.6908990003886],[132.56493000012,47.717381000333],[132.651730000039,47.9477649999549],[133.042499999875,48.1066130002898],[133.525419999933,48.1112290000185],[134.188890000173,48.382369999576],[134.541290000433,47.9884150003521],[134.770900000335,47.7128639997738],[134.168690000343,47.3237230004162],[134.225850000377,47.1269569997658],[133.839810000131,46.4755520001248],[133.919420000333,46.2656249995941],[133.457990000239,45.8321990003837],[133.467219999603,45.6170039997349],[133.133210000241,45.4256860003088],[133.131069999581,45.1245960001054],[132.945450000317,45.0155599999942],[131.875350000003,45.3393249999488],[131.487239999626,44.9674799996025],[131.301830000155,44.0419120004385],[131.31047000019,43.3955610000403],[131.135480000102,42.9334869999252],[130.392820000143,42.7253189995723],[130.251849999578,42.7074320002866],[129.704249999838,42.4265100002364],[128.910959999704,42.0098420004081],[128.3099999998,41.5999490000464],[127.253980000377,41.4777259997551],[126.941050000058,41.8070909998498],[126.697269999611,41.7479290001233],[126.529390000049,41.3530390000499],[126.0221299999,40.8983759999526],[124.897320000118,40.4797129998551],[123.274380000337,39.6943779996452],[122.372179999607,39.4199139997314],[121.870790000358,38.9514160001484],[121.694442999745,38.8658270003159],[121.194749999613,38.7216840000168],[121.096340000291,38.9300959999305],[121.472279999722,39.8072319995572],[121.895213999826,40.0054600001789],[122.292624000098,40.4516659996863],[121.96437400016,40.8984849995832],[121.909380000187,40.9564780002596],[121.0220000003,40.7140239998078],[120.592499999575,40.469307000218],[119.367939999831,39.7496570001705],[119.302937999689,39.3927760001125],[119.011207000303,39.2036179995712],[118.204616000128,39.1077860004237],[118.008579999867,39.2257159996937],[117.736429999645,39.0976180000708],[117.527700000355,38.630370999722],[118.027689999794,38.0756719999629],[118.475899999985,38.112614000236],[118.643449999618,38.1357230002164],[118.929249999788,38.094067000192],[119.102120000138,37.8258089995858],[118.891509999587,37.2904589999828],[119.183720000378,37.1055720003475],[119.749569999956,37.1216430004242],[119.909900000285,37.2697219996706],[120.307750000162,37.6012079995497],[120.741109999927,37.8318369996778],[121.56073452591,37.8769305529481],[122.70292999972,37.3949550002731],[122.622249999638,37.194321000214],[122.571910000246,37.0391880003261],[122.415339999741,36.8644829998906],[122.17872999989,36.8457569996858],[120.964370000176,36.5800590002228],[120.878150000023,36.3687780002045],[120.706050000108,36.1258850001928],[120.296540000321,35.9703479996605],[119.999960000354,35.8598519996702],[119.868919999958,35.6152950002642],[119.623977999885,35.6065479997903],[119.181539999671,34.8800050002307],[120.27866499979,34.3036999996553],[120.846189000122,32.6104450002367],[121.592594000113,32.4105770004284],[121.841579999617,31.9234289996487],[121.89372999974,31.6206990002588],[121.87687000015,31.4859869996004],[121.726679999782,31.2707840003814],[121.89647000019,30.8868710001967],[122.13332999988,29.9006229996518],[121.664687000938,28.3482841171503],[121.664670000021,28.3482799999222],[121.664683755448,28.3482733667487],[121.663847999885,28.3455049996562],[119.02339999961,24.9618759996778],[118.64816100013,24.5575260004246],[118.140240000076,24.269917999616],[116.501004050996,22.9427799998971],[115.818924051404,22.7460989995693],[114.885814050678,22.5488849998429],[114.603074051326,22.4988690001044],[113.587874051147,22.2412659998261],[112.561324050964,21.7579080002542],[112.394674050567,21.7346359999515],[111.784464051275,21.6216140003858],[111.431454050764,21.5912650001798],[111.031014051058,21.5375370001325],[110.282234051261,20.2446630003973],[109.918774050882,20.224514000221],[109.668004050946,20.8931349996806],[109.787604050786,21.4237329995784],[109.65292999972,21.5599989999539],[109.222589999829,21.3508340003889],[109.040770000435,21.445040000096],[109.152240000376,21.5198540003619],[108.59249099976,21.716710999813],[108.548990000089,21.5666889999974],[108.107380000287,21.4623929999371],[107.858280000022,21.653614000286],[107.361079999742,21.6009750000962],[107.023409999772,21.9455639998788],[106.690310000106,21.9646969999667],[106.557439999856,22.4632780000798],[106.835139999711,22.8055079998944],[106.137779999647,22.9963299998298],[105.876880000212,22.9173109999028],[105.32512999975,23.3926809998284],[104.803340000441,23.1182000000301],[104.730930000419,22.8225149999673],[104.368270000061,22.6895370001324],[104.113020000373,22.8096809998783],[103.97259999999,22.5088229995819],[103.656560000144,22.7911169999496],[103.527050000157,22.5955620002862],[103.324419999783,22.8104900003133],[103.073030000035,22.4481809999533],[102.492269999961,22.7809470004038],[102.259860000439,22.415520000148],[101.671419999633,22.476095000284],[101.548360000314,22.2341330000381],[101.834970000066,21.6214639997638],[101.758539999921,21.1431269997113],[101.216930000319,21.2322119997841],[101.120750000412,21.7786449996671],[100.58112999995,21.4521709997919],[100.131439999856,21.5064199995835],[99.9702589998531,22.0551949995498],[99.1552659998261,22.1590370002575],[99.3781360000764,22.5005569997059],[99.3151549996037,22.7426820002742],[99.5616070000631,22.9456370003474],[99.5137019996477,23.0837519996552],[98.8851550001033,23.1871410001571],[98.8903349997606,23.6154770002635],[98.673285999949,23.8073900001485],[98.8795170000097,24.1554109999178],[98.1014470002789,24.0926089996057],[97.6483139996914,23.842463999714],[97.531394000233,23.9268170001045],[97.7658149998625,24.2611099999266],[97.5280600002689,24.4362260004296],[97.5504830000904,24.7463679998834],[97.796331999722,24.8488920000659],[97.7210230000116,25.0852180003106],[98.1368319997971,25.3897819997396],[98.1681889997226,25.6281679996535],[98.3125369995829,25.5462530001759],[98.5180889998077,25.8357510000087],[98.7045669999672,25.8552420004181],[98.5777209996245,26.1228030003583],[98.7178500000775,26.131027000096],[98.7814480002251,26.6248930004117],[98.7064290003982,27.5596139998862],[98.4416799997323,27.6693479998105],[98.3155740002401,27.5230809995886],[98.1384190001369,28.1456600000091],[97.6636890000474,28.5367850000279],[97.3497309999857,28.2394680002481],[97.3856430004241,27.8838419996086],[97.0965120004287,27.7444800003519],[96.2764359998216,28.2308809999582],[95.7358400002158,28.276854000312],[95.2550129995504,27.924473000029],[94.2719270000312,27.583404999841],[93.8295970003015,27.0296339997093],[93.5461659996612,26.9381929998073],[92.0835069997484,26.856111999869],[92.1242140000762,27.2829910002345],[92.014258999853,27.4787009998514],[91.5940319995773,27.5396690001244],[91.6209259996353,27.8804190000369],[91.4638979995931,28.0071830001955],[91.3121490001764,28.061321000264],[90.9589390003347,27.8314479999254],[90.7979130002848,28.0438420000085],[89.7955470001939,28.2481500004224],[89.2364879999213,27.8014089996256],[89.1772229999416,27.3765139999213],[88.9901809998534,27.2144089995757],[88.7797549996936,27.4660209996695],[88.8886410000822,27.8592870003949],[88.7520599995694,28.0782739996455],[88.1085279996675,27.867159000088],[87.1908789996661,27.8204600004289],[86.703094000088,28.1084920001058],[86.4107799998973,27.9050089999656],[86.1832430002643,28.1738610000852],[86.0198319999469,27.9068949997047],[85.7102809998684,28.385767000147],[85.6101609999303,28.2568719997432],[85.1203919996912,28.3362560003143],[85.1865229997367,28.643408000379],[84.8579639999388,28.5717259997552],[84.4600519999,28.7530820002342],[84.2268600002889,28.8948800003119],[84.0935749997865,29.2942579996071],[83.5811160000036,29.1774429995948],[83.2818910003695,29.5676650002397],[82.1735229997867,30.065217999711],[82.0847780001047,30.359060000219],[81.4106599998592,30.4193190001719],[81.1556779999399,30.0091529998111],[81.0323410004369,30.2470020001422],[80.0457690002393,30.5971150001573],[79.7552950003641,30.9447520002047],[79.0071409997574,31.0426809998283],[78.7504730003288,31.3651959996957],[78.8455960000554,31.612063999554],[78.649475000371,31.8307910003046],[78.7665630003822,31.948927000081],[78.4573359999566,32.1343379995991],[78.3944169996449,32.5323560000294],[78.7407529999511,32.7081110003226],[78.9687419997437,32.33878700022],[79.3055040001096,32.6038819997546],[79.164627000236,33.1709749999964],[78.6793520003947,33.6660920004455],[78.7764969998369,33.743526000125],[78.6606519995903,34.0854110002176],[79.0407029997438,34.3364409995527],[78.2705609995906,34.634471999883],[78.0045469999441,35.229088000411],[78.135337999649,35.492404999791],[77.1980899996539,35.5200120003536],[76.762321000314,35.6621550001533],[76.5685350003901,35.9253730003637],[76.1623920002908,35.822997999858],[75.9408490000814,36.0711820001492],[76.0605009996215,36.233130999596],[75.8629379999888,36.670417999691],[75.4505159999135,36.7273710000717],[75.4014740001251,36.957049999558],[74.503448000325,37.0641139995616],[74.5046920001359,37.2367669997974],[74.8826980004125,37.2220690000844],[75.1516650004396,37.4107359995669],[74.9085239997829,37.5922550003681],[75.0046010003361,37.778224999584],[74.7970349998654,38.1666029997288],[74.8674159998487,38.4722899996838],[74.399085999919,38.6616670004319],[73.9956129997402,38.5215260003248],[73.560378999891,38.8149030000735],[73.8541790002607,38.9527319996821],[73.4419170003694,39.321308000364],[73.8012920003257,39.5079960003151],[73.9359280001771,40.0297659996014],[74.9019240002925,40.337959000008],[74.8379360001463,40.5224989998292],[75.2243270003909,40.4450300003344],[75.5870970004264,40.6621479997305],[75.6996540001321,40.2810780002497],[76.2714230001714,40.4387860001739],[76.3407439998359,40.3392140003259],[76.8744960003902,41.0265729996443],[77.4078139998164,41.0377810002931],[77.3322979995532,41.2432939996185],[77.7578350000853,41.2984580002366],[77.9366379997439,41.495723999663],[78.645828000362,41.4696620002011],[80.2820209997694,42.2330970004262],[80.1612780002795,42.6261520004147],[80.2588420001582,42.8260879997616],[80.5973279999874,42.8887859997742],[80.3797910001546,43.0246470003588],[80.8068469996894,43.1772610000951],[80.3992160002183,44.1095540000171],[80.4095760004323,44.6089780003346],[79.8859710001616,44.9137460001779],[81.774101000261,45.3874359999716],[82.1010820001342,45.2002979999529],[82.5685730000441,45.223983999562],[82.2495650000249,45.6524809998983],[83.0289310001657,47.221100000165],[83.9176560000245,46.9713670003868],[85.5353160000336,47.0496860004087],[85.6987919997511,47.2859339997544],[85.5599059999621,48.149524999779],[85.7893450000718,48.4191440001956],[86.5814670003019,48.5403749997065],[86.9076120002937,49.134004999731],[87.8171690003492,49.1701890001224],[87.8992769997339,48.9769520003346],[87.7384489998215,48.8693889998025],[88.0893629999026,48.713074000265],[87.9707570000356,48.5725060002519],[88.5135209997944,48.4017650000547],[88.6392869997953,48.178280000222],[89.0586400002359,47.989601000186],[89.5748359996817,48.033390999695],[89.7614970001865,47.8294489999715],[90.0611649995652,47.88716100028],[90.3747100003663,47.6613389996953],[90.5593490002562,47.2129209998045],[91.0462110004374,46.721457999687],[90.8916020004321,46.3123630001524],[91.0211409999573,46.0247989995743],[90.6685709999518,45.5472150000723],[90.881736999663,45.1912499999876],[93.5069889997427,44.9671289996038],[94.7235549995638,44.3387929998971],[95.4103269996913,44.2929100000965],[95.3244340002291,44.0244740002751],[95.5246659997362,44.0001340001841],[95.8788909996201,43.2740969996768],[96.3883729997143,42.7244429996449],[97.1820980001228,42.7920680002381],[99.4961240002226,42.5676040002246],[100.848070000031,42.6718940000083],[101.798900000435,42.5031969996419],[102.074650000297,42.2272610001951],[103.419910000246,41.8797299996399],[104.522779999997,41.8742030001685],[104.516580000067,41.6613080003641],[105.005709999617,41.5826950002742],[107.459630000124,42.4565430002594],[109.534570000405,42.4690899997038],[110.431119999588,42.7795260001249],[111.012340000191,43.3260990001688],[111.945779999947,43.6899149998774],[111.410290000183,44.3564949996446],[111.970269999761,45.083607000263],[113.627849999778,44.7431110003725],[114.107580000217,44.9527850000278],[114.542430000344,45.384754000397],[115.356190000169,45.3888850002427],[116.172780000097,45.6907880001662],[116.57773000004,46.288635000405],[117.368109999977,46.3604580003366],[117.413830000354,46.5808450002966],[117.716180000207,46.5128359999815],[118.895130000149,46.7749559999197],[119.299079999842,46.6092489998415],[119.902120000338,46.6657300000396],[119.709629999925,47.1936420001782],[118.558819999943,47.9919279995776],[117.809420000333,48.0160139996464],[117.372540000121,47.6403660001909],[116.798,47.8987959999355],[116.257059999819,47.8787350002202],[115.934470000091,47.6804240002675],[115.573039999796,47.9190600000191],[115.520770000435,48.1513860001639],[115.812339999591,48.255538999925],[115.786429999945,48.5225790001209],[116.714489999814,49.8460960001303],[117.801090000203,49.5168229997818],[119.33887000015,50.1627539996974],[119.360569999906,50.3466450001667],[119.11860000019,50.3839189995624],[119.273640000286,50.6027679996436],[120.078789999659,51.6768189995973],[120.650570000205,51.9267810000432],[120.77959999964,52.1575389998251],[120.612219999753,52.35425199983],[120.721910000346,52.5433850001178],[120.057820000293,52.5863910003444],[120.027229999765,52.7758670002619],[120.875170000195,53.2921710001917],[123.478660000359,53.4960939999383]],[[120.419657999617,36.0468899995739],[120.419383999572,36.051671999763],[120.415950000392,36.0480409995926],[120.419657999617,36.0468899995739]],[[120.576840999613,36.0898860002388],[120.570404999591,36.0875450002018],[120.581467999848,36.0847560001893],[120.576840999613,36.0898860002388]],[[78.3979950000693,41.3937719997781],[78.4014130003099,41.3924449997371],[78.3920059999771,41.3971140001111],[78.3979950000693,41.3937719997781]]]]}");
        temperatureService.insert(t);

    }

    @Test
    public void existsTable() {
        try {
            Date refTime = sdf.parse("2019-08-29 11:00:00");
            boolean exists = this.temperatureService.existsTable(refTime,10000,true);
            System.out.println("table" + (exists?"存在":"不存在"));
        } catch (ParseException e) {
            e.printStackTrace();
        }
    }

    @Test
    public void subsTable() {
        List<String> subTables = this.temperatureService.getSubTables();
        for (String tableName: subTables) {
            System.out.println(tableName);
        }
    }
}